{"version":3,"file":"radio.js","sources":["../../src/radio/radio.tsx"],"sourcesContent":["import { defineComponent, inject, toRefs, computed, ref } from 'vue';\nimport { usePrefixClass, useCommonClassName } from '../hooks/useConfig';\nimport { omit } from '../utils/helper';\nimport props from './props';\nimport { RadioGroupInjectionKey, RadioButtonInjectionKey } from './constants';\n\n// hooks\nimport { useDisabled } from '../hooks/useDisabled';\nimport useVModel from '../hooks/useVModel';\nimport { useContent } from '../hooks/tnode';\nimport isUndefined from 'lodash/isUndefined';\nimport isString from 'lodash/isString';\n\nfunction getValidAttrs(obj: Record<string, any>): Record<string, any> {\n  const newObj = {};\n  Object.keys(obj).forEach((key) => {\n    if (!isUndefined(obj[key])) {\n      newObj[key] = obj[key];\n    }\n  });\n  return newObj;\n}\n\nexport default defineComponent({\n  name: 'TRadio',\n  inheritAttrs: false,\n  props: { ...props },\n\n  setup(props, { attrs }) {\n    const inputRef = ref();\n    const { checked, modelValue } = toRefs(props);\n    const [innerChecked, setInnerChecked] = useVModel(\n      checked,\n      modelValue,\n      props.defaultChecked,\n      props.onChange,\n      'checked',\n    );\n\n    const radioChecked = computed(() => (radioGroup ? props.value === radioGroup.value : innerChecked.value));\n\n    const radioGroup = inject(RadioGroupInjectionKey, undefined);\n\n    const allowUncheck = computed(() => Boolean(props.allowUncheck || radioGroup?.allowUncheck));\n\n    const handleClick = (e: MouseEvent) => {\n      e.stopPropagation();\n    };\n\n    const onLabelClick = (e: MouseEvent) => {\n      if (isDisabled.value || props.readonly) return;\n      props.onClick?.({ e });\n\n      if (radioChecked.value && !allowUncheck.value) return;\n\n      if (radioGroup) {\n        const value = radioChecked.value && allowUncheck.value ? undefined : props.value;\n        radioGroup.setValue(value, { e });\n      } else {\n        const value = allowUncheck.value ? !radioChecked.value : true;\n        setInnerChecked(value, { e });\n      }\n    };\n\n    const inputEvents = computed(() =>\n      getValidAttrs({\n        focus: attrs.onFocus,\n        blur: attrs.onBlur,\n        keydown: attrs.onKeydown,\n        keyup: attrs.onKeyup,\n        keypresss: attrs.onKeypresss,\n      }),\n    );\n    const wrapperAttrs = computed(() => {\n      const events = [...Object.keys(inputEvents.value), 'input', 'change'].map(\n        (str) => `on${str[0].toUpperCase()}${str.slice(1)}`,\n      );\n      return omit(attrs, events);\n    });\n    /** Event END */\n\n    // extend radioGroup disabled props\n    const groupDisabled = computed(() => radioGroup?.disabled);\n    const isDisabled = useDisabled({ afterDisabled: groupDisabled });\n\n    // attribute\n    const inputProps = computed(() => ({\n      name: radioGroup ? radioGroup.name : props.name,\n      checked: radioChecked.value,\n      disabled: isDisabled.value,\n      readonly: props.readonly,\n      value: props.value,\n    }));\n\n    /** Style */\n    const { STATUS } = useCommonClassName();\n    const radioButton = inject(RadioButtonInjectionKey, undefined);\n    const radioBtnName = usePrefixClass('radio-button');\n    const COMPONENT_NAME = usePrefixClass('radio');\n    const prefixCls = computed(() => (radioButton ? radioBtnName.value : COMPONENT_NAME.value));\n    const inputClass = computed(() => [\n      `${prefixCls.value}`,\n      {\n        [STATUS.value.checked]: inputProps.value.checked,\n        [STATUS.value.disabled]: inputProps.value.disabled,\n      },\n    ]);\n    /** Style END */\n\n    const renderContent = useContent();\n\n    return () => (\n      <label\n        ref={inputRef}\n        class={inputClass.value}\n        {...wrapperAttrs.value}\n        tabindex={isDisabled.value ? undefined : '0'}\n        onClick={onLabelClick}\n      >\n        <input\n          type=\"radio\"\n          class={`${prefixCls.value}__former`}\n          {...inputEvents.value}\n          {...inputProps.value}\n          onClick={handleClick}\n          tabindex=\"-1\"\n          data-value={isString(props.value) ? `'${props.value}'` : props.value}\n          data-allow-uncheck={allowUncheck.value || undefined}\n        />\n        <span class={`${prefixCls.value}__input`}></span>\n        <span class={`${prefixCls.value}__label`}>{renderContent('default', 'label')}</span>\n      </label>\n    );\n  },\n});\n"],"names":["getValidAttrs","obj","newObj","Object","keys","forEach","key","isUndefined","defineComponent","name","inheritAttrs","props","_objectSpread","setup","attrs","_ref","inputRef","ref","_toRefs","toRefs","checked","modelValue","_useVModel","useVModel","defaultChecked","onChange","_useVModel2","_slicedToArray","innerChecked","setInnerChecked","radioChecked","computed","radioGroup","value","inject","RadioGroupInjectionKey","allowUncheck","Boolean","handleClick","e","stopPropagation","onLabelClick","_props2$onClick","isDisabled","readonly","onClick","setValue","inputEvents","focus","onFocus","blur","onBlur","keydown","onKeydown","keyup","onKeyup","keypresss","onKeypresss","wrapperAttrs","events","concat","_toConsumableArray","map","str","toUpperCase","slice","omit","groupDisabled","disabled","useDisabled","afterDisabled","inputProps","_useCommonClassName","useCommonClassName","STATUS","radioButton","RadioButtonInjectionKey","radioBtnName","usePrefixClass","COMPONENT_NAME","prefixCls","inputClass","_defineProperty","renderContent","useContent","_createVNode","_mergeProps","isString"],"mappings":"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"}